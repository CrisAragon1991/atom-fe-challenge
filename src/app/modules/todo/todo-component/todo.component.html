<div class="container py-4">
	<app-edit 
		*ngIf="showEditModal() && selectedTodo()" 
		[todo]="selectedTodo()!" 
		(updated)="updateTodo($event)" 
		(closed)="closeEditModal()">
	</app-edit>
	<div class="row justify-content-center">
		<div class="col-12 col-md-8 col-lg-6">
			<div class="d-flex justify-content-between align-items-center mb-4">
				<h2 class="mb-0">Mis Tareas</h2>
				<button class="btn btn-success" type="button" (click)="openNewTodoModal()">
					<i class="bi bi-plus"></i> Agregar
				</button>
			</div>
			<div *ngFor="let todo of todos()" class="card mb-3 shadow-sm">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center">
						<h5 class="card-title mb-0">{{ todo.name }}</h5>
						<div *ngIf="todo.stateId === '1'">
							<input
								type="checkbox"
								class="form-check-input form-check-lg border border-primary shadow-lg"
								style="cursor: pointer;"
								data-bs-toggle="tooltip"
								data-bs-placement="top"
								data-bs-custom-class="custom-tooltip"
								title="Haz clic para marcar como completada"
								(change)="onCheckboxComplete(todo, $event)"
							/>
						</div>
					</div>
					<p class="card-text">{{ todo.description }}</p>
					<div class="d-flex justify-content-between align-items-center mt-3">
						<span 
							class="badge" 
							[ngClass]="{
								'bg-success': todo.stateId === '1',
								'bg-secondary': todo.stateId === '2'
							}"
						>
							{{ todo.stateId === '1' ? 'Pendiente' : (todo.stateId === '2' ? 'Completado' : 'Desconocido') }}
						</span>
						<div class="d-flex gap-2">
							<button class="btn btn-outline-primary btn-sm" type="button" (click)="openEditModal(todo)">
								<i class="bi bi-pencil"></i> Editar
							</button>
							<button class="btn btn-outline-danger btn-sm" type="button" (click)="deleteTodo(todo)">
								<i class="bi bi-trash"></i> Eliminar
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
